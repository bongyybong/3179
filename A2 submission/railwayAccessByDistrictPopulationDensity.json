{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "Railway Access by District Population Density",
    "font": "Elgraine",
    "fontSize": 28
  },
  "width": 700,
  "height": 500,
  "params": [
    {
      "name": "Zoom",
      "value": 4075,
      "bind": {"input": "range", "min": 2000, "max": 15000, "step": 5}
    },
    {
      "name": "hScr",
      "value": 101.9,
      "bind": {"input": "range", "min": 95, "max": 105, "name": "Horizontal Scroll"}
    },
    {
      "name": "vScr",
      "value": 4.1,
      "bind": {"input": "range", "min": 0, "max": 7, "name": "Vertical Scroll"}
    }
  ],
  "projection": {
    "type": "equalEarth",
    "scale": {"expr": "Zoom"},
    "center": {"expr": "[hScr, vScr]"}
  },
  "layer": [
    {
      "data": {
        "url": "gadm41_MYS_2.json",
        "format": { "type": "topojson", "feature": "gadm41_MYS_2" }
      },
      "transform": [
        {
          "lookup": "properties.NAME_2",
          "from": {
            "data": {
              "url": "population_info.csv"
            },
            "key": "district",
            "fields": ["population", "area_km2"]
          }
        },
        {
          "calculate": "datum.population / datum.area_km2",
          "as": "Population Density"
        }
      ],
      "mark": { "type": "geoshape" },
      "encoding": {
        "color": {
          "field": "Population Density",
          "type": "quantitative",
          "scale": { "type": "log" },
          "legend": {
            "titleFont": "Elgraine",
            "titleFontSize": 20,
            "labelFont": "Elgraine",
            "labelFontSize": 16
          }
        },
        "tooltip": [
          {
            "field": "properties.NAME_1",
            "type": "nominal",
            "title": "State"
          },
          {
            "field": "properties.NAME_2",
            "type": "nominal",
            "title": "District"
          },
          {
            "field": "population",
            "type": "quantitative",
            "title": "Population"
          },
          {
            "field": "area_km2",
            "type": "quantitative",
            "title": "Area (km²)"
          },
          {
            "field": "Population Density",
            "type": "quantitative",
            "title": "Population Density (people per km²)"
          }
        ]
      }
    },
    {
      "data": {
        "url": "gadm41_MYS_2.json",
        "format": { "type": "topojson", "feature": "gadm41_MYS_2" }
      },
      "mark": {
        "type": "geoshape",
        "fill": null,
        "stroke": "black",
        "strokeWidth": 1
      }
    },
    {
      "data": {
        "url": "railwayAndStation.json",
        "format": { "type": "topojson", "feature": "export" }
      },
      "mark": {
        "type": "geoshape",
        "fill": null,
        "stroke": "red",
        "strokeWidth": 2.5
      }
    }
  ]
}
